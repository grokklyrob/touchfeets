{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/robertstevens/Touchfeets/web/components/UploadWidget.tsx"],"sourcesContent":["\"use client\";\n\nimport React, { useCallback, useEffect, useRef, useState } from \"react\";\n\ntype StylePreset = \"BYZANTINE\" | \"GOTHIC\" | \"CYBERPUNK\";\ntype OutputFormat = \"png\" | \"webp\";\n\ntype JobStatus = \"QUEUED\" | \"PROCESSING\" | \"BLOCKED\" | \"COMPLETED\" | \"FAILED\";\n\ntype JobResponse = {\n  id: string;\n  status: JobStatus;\n  inputBlobUrl: string;\n  outputBlobUrl?: string;\n  style?: StylePreset;\n  blockedReason?: string | null;\n  createdAt: string;\n  completedAt?: string | null;\n};\n\ntype UploadResult = {\n  url: string;\n  pathname: string;\n  contentType: string;\n  size?: number;\n};\n\nfunction classNames(...xs: Array<string | false | null | undefined>) {\n  return xs.filter(Boolean).join(\" \");\n}\n\n/**\n * Upload & Generate Widget (Task 9)\n *\n * Features:\n * - Drag/drop or click-to-upload image\n * - Inline style selector (Task 10 will extract to a dedicated StyleSelector)\n * - Optional prompt variant\n * - Output format selector (png/webp, default png)\n * - Calls:\n *   - POST /api/upload-url (multipart form-data)\n *   - POST /api/generate (JSON)\n *   - Poll GET /api/jobs/[id]\n *   - Preview and Download via GET /api/download/[id]\n *\n * Notes:\n * - Requires authenticated session (NextAuth). If 401 on generate, prompts to sign in.\n * - Server validates content-type, size, rate limits, quotas, and safety.\n *\n * See server contracts:\n * - Generate: web/app/api/generate/route.ts\n * - Upload: web/app/api/upload-url/route.ts\n * - Jobs: web/app/api/jobs/[id]/route.ts\n * - Download: web/app/api/download/[id]/route.ts\n */\nexport default function UploadWidget() {\n  const [file, setFile] = useState<File | null>(null);\n  const [dragOver, setDragOver] = useState(false);\n\n  const [style, setStyle] = useState<StylePreset>(\"BYZANTINE\");\n  const [promptVariant, setPromptVariant] = useState(\"\");\n  const [format, setFormat] = useState<OutputFormat>(\"png\");\n\n  const [busy, setBusy] = useState(false);\n  const [phase, setPhase] = useState<\n    | \"idle\"\n    | \"picking\"\n    | \"uploading\"\n    | \"queued\"\n    | \"processing\"\n    | \"blocked\"\n    | \"failed\"\n    | \"completed\"\n  >(\"idle\");\n\n  const [message, setMessage] = useState<string | null>(null);\n\n  const [jobId, setJobId] = useState<string | null>(null);\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [blockedReason, setBlockedReason] = useState<string | null>(null);\n\n  const pollRef = useRef<NodeJS.Timeout | null>(null);\n\n  useEffect(() => {\n    return () => {\n      if (pollRef.current) {\n        clearInterval(pollRef.current as any);\n        pollRef.current = null;\n      }\n    };\n  }, []);\n\n  const clearState = useCallback(() => {\n    setBusy(false);\n    setPhase(\"idle\");\n    setMessage(null);\n    setJobId(null);\n    setDownloadUrl(null);\n    setPreviewUrl(null);\n    setBlockedReason(null);\n    if (pollRef.current) {\n      clearInterval(pollRef.current as any);\n      pollRef.current = null;\n    }\n  }, []);\n\n  const onSelectFile = useCallback((f: File) => {\n    setFile(f);\n    setPhase(\"picking\");\n    setMessage(null);\n    setJobId(null);\n    setDownloadUrl(null);\n    setPreviewUrl(null);\n    setBlockedReason(null);\n  }, []);\n\n  const onFileInput = useCallback((e: React.ChangeEvent<HTMLInputElement>) => {\n    const f = e.target.files?.[0];\n    if (f) onSelectFile(f);\n  }, [onSelectFile]);\n\n  const onDrop = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(false);\n    const f = e.dataTransfer.files?.[0];\n    if (f) onSelectFile(f);\n  }, [onSelectFile]);\n\n  const onDragOver = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(true);\n  }, []);\n  const onDragLeave = useCallback((e: React.DragEvent<HTMLDivElement>) => {\n    e.preventDefault();\n    e.stopPropagation();\n    setDragOver(false);\n  }, []);\n\n  async function uploadToBlob(selected: File): Promise<UploadResult> {\n    setPhase(\"uploading\");\n    setMessage(\"Uploading...\");\n    const fd = new FormData();\n    fd.append(\"file\", selected);\n    const res = await fetch(\"/api/upload-url\", {\n      method: \"POST\",\n      body: fd,\n    });\n    if (!res.ok) {\n      const err = await safeJson(res);\n      throw new Error(err?.error || `Upload failed (${res.status})`);\n    }\n    return (await res.json()) as UploadResult;\n  }\n\n  async function startGeneration(upload: UploadResult): Promise<{ id: string }> {\n    setPhase(\"queued\");\n    setMessage(\"Starting generation...\");\n    const body: any = {\n      inputUrl: upload.url,\n      style,\n      outputFormat: format,\n    };\n    if (promptVariant.trim().length > 0) {\n      body.promptVariant = promptVariant.trim().slice(0, 200);\n    }\n\n    const res = await fetch(\"/api/generate\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      body: JSON.stringify(body),\n    });\n\n    if (res.status === 401) {\n      throw new Error(\"You must sign in to generate images. Please sign in and try again.\");\n    }\n    if (!res.ok) {\n      const err = await safeJson(res);\n      throw new Error(err?.error || `Generate failed (${res.status})`);\n    }\n    const json = await res.json();\n    if (!json?.id) throw new Error(\"Generate did not return a job id\");\n    return { id: json.id as string };\n  }\n\n  function startPolling(id: string) {\n    setPhase(\"processing\");\n    setMessage(\"Processing with Gemini...\");\n    setJobId(id);\n\n    if (pollRef.current) clearInterval(pollRef.current as any);\n\n    const tick = async () => {\n      try {\n        const res = await fetch(`/api/jobs/${id}`);\n        if (!res.ok) {\n          if (res.status === 401) {\n            throw new Error(\"Session expired. Please sign in again.\");\n          }\n          // brief backoff but do not stop\n          return;\n        }\n        const job = (await res.json()) as JobResponse;\n        switch (job.status) {\n          case \"QUEUED\":\n            setPhase(\"queued\");\n            setMessage(\"Queued...\");\n            break;\n          case \"PROCESSING\":\n            setPhase(\"processing\");\n            setMessage(\"Processing with Gemini...\");\n            break;\n          case \"COMPLETED\": {\n            setPhase(\"completed\");\n            setMessage(\"Completed\");\n            const dl = `/api/download/${id}`;\n            setDownloadUrl(dl);\n            setPreviewUrl(dl + \"#inline-preview\"); // same url; hint not used by server\n            if (pollRef.current) {\n              clearInterval(pollRef.current as any);\n              pollRef.current = null;\n            }\n            break;\n          }\n          case \"BLOCKED\": {\n            setPhase(\"blocked\");\n            const reason = job.blockedReason || \"SAFETY\";\n            setBlockedReason(reason);\n            setMessage(humanBlockedReason(reason));\n            if (pollRef.current) {\n              clearInterval(pollRef.current as any);\n              pollRef.current = null;\n            }\n            break;\n          }\n          case \"FAILED\": {\n            setPhase(\"failed\");\n            setMessage(\"Generation failed. Please try another image or later.\");\n            if (pollRef.current) {\n              clearInterval(pollRef.current as any);\n              pollRef.current = null;\n            }\n            break;\n          }\n          default:\n            break;\n        }\n      } catch (err: any) {\n        // keep polling a bit; if repeated, it will stop when user resets\n        setMessage(err?.message || \"Polling error\");\n      }\n    };\n\n    // Immediate tick then interval\n    tick();\n    pollRef.current = setInterval(tick, 1500) as any;\n  }\n\n  async function onStart() {\n    if (!file) {\n      setMessage(\"Please choose an image to upload.\");\n      return;\n    }\n    try {\n      setBusy(true);\n      setMessage(null);\n      setPhase(\"uploading\");\n      setDownloadUrl(null);\n      setPreviewUrl(null);\n      setJobId(null);\n      const uploaded = await uploadToBlob(file);\n      const { id } = await startGeneration(uploaded);\n      startPolling(id);\n    } catch (err: any) {\n      setBusy(false);\n      if (err?.message?.includes(\"sign in\")) {\n        setPhase(\"failed\");\n      } else {\n        setPhase(\"failed\");\n      }\n      setMessage(err?.message || \"Unexpected error\");\n    } finally {\n      // busy stays true while polling; will flip on terminal states where appropriate\n    }\n  }\n\n  function onReset() {\n    clearState();\n    setFile(null);\n  }\n\n  function humanBlockedReason(reason: string): string {\n    const r = reason.toUpperCase();\n    if (r.includes(\"SAFETY\")) {\n      return \"Blocked by model safety. Try a different image or less sensitive content.\";\n    }\n    if (r.includes(\"RATE\")) {\n      return \"You’ve hit the rate limit. Please wait a minute and try again.\";\n    }\n    if (r.includes(\"QUOTA\")) {\n      return \"Monthly quota exceeded. Upgrade a plan to continue.\";\n    }\n    if (r.includes(\"UPLOAD_NOT_CONFIGURED\")) {\n      return \"Output storage not configured. Contact support.\";\n    }\n    if (r.includes(\"MODEL\")) {\n      return \"Model error. Please try again.\";\n    }\n    return \"Blocked. Please adjust your input and try again.\";\n  }\n\n  return (\n    <div className=\"w-full max-w-2xl mx-auto border rounded-lg p-4 bg-white/70 dark:bg-neutral-900/60 shadow-sm\">\n      <h2 className=\"text-xl font-semibold mb-3\">Upload & Generate</h2>\n\n      {/* Dropzone */}\n      <div\n        onDrop={onDrop}\n        onDragOver={onDragOver}\n        onDragLeave={onDragLeave}\n        className={classNames(\n          \"relative border-2 border-dashed rounded-md p-6 transition-colors\",\n          dragOver ? \"border-blue-500 bg-blue-50 dark:bg-blue-950/20\" : \"border-neutral-300\"\n        )}\n      >\n        <div className=\"flex flex-col items-center justify-center text-center gap-2\">\n          <div className=\"text-sm text-neutral-600 dark:text-neutral-300\">\n            Drag & drop an image here, or click to select\n          </div>\n          <input\n            type=\"file\"\n            accept=\"image/jpeg,image/png,image/webp,image/heic,image/heif\"\n            className=\"absolute inset-0 opacity-0 cursor-pointer\"\n            onChange={onFileInput}\n            aria-label=\"Select image\"\n          />\n          {file && (\n            <div className=\"text-xs text-neutral-700 dark:text-neutral-300\">\n              Selected: <strong>{file.name}</strong> ({Math.round(file.size / 1024)} KB)\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Controls */}\n      <div className=\"mt-4 grid grid-cols-1 md:grid-cols-3 gap-3\">\n        {/* Style (inline for Task 9; extracted in Task 10) */}\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm font-medium\">Style</span>\n          <select\n            value={style}\n            onChange={(e) => setStyle(e.target.value as StylePreset)}\n            className=\"border rounded-md px-2 py-1 bg-white dark:bg-neutral-900\"\n          >\n            <option value=\"BYZANTINE\">Byzantine</option>\n            <option value=\"GOTHIC\">Gothic</option>\n            <option value=\"CYBERPUNK\">Cyberpunk</option>\n          </select>\n        </label>\n\n        {/* Output format */}\n        <label className=\"flex flex-col gap-1\">\n          <span className=\"text-sm font-medium\">Output format</span>\n          <select\n            value={format}\n            onChange={(e) => setFormat(e.target.value as OutputFormat)}\n            className=\"border rounded-md px-2 py-1 bg-white dark:bg-neutral-900\"\n          >\n            <option value=\"png\">PNG</option>\n            <option value=\"webp\">WebP</option>\n          </select>\n        </label>\n\n        {/* Prompt variant */}\n        <label className=\"flex flex-col gap-1 md:col-span-1 md:col-start-3 md:row-start-1\">\n          <span className=\"text-sm font-medium\">Prompt variant (optional)</span>\n          <input\n            type=\"text\"\n            value={promptVariant}\n            onChange={(e) => setPromptVariant(e.target.value)}\n            placeholder=\"e.g. warm golden hour light\"\n            maxLength={200}\n            className=\"border rounded-md px-2 py-1 bg-white dark:bg-neutral-900\"\n          />\n        </label>\n      </div>\n\n      {/* Actions */}\n      <div className=\"mt-4 flex items-center gap-2\">\n        <button\n          type=\"button\"\n          onClick={onStart}\n          disabled={!file || busy || phase === \"processing\" || phase === \"queued\"}\n          className={classNames(\n            \"px-4 py-2 rounded-md text-white\",\n            (!file || busy || phase === \"processing\" || phase === \"queued\")\n              ? \"bg-neutral-400 cursor-not-allowed\"\n              : \"bg-blue-600 hover:bg-blue-700\"\n          )}\n        >\n          {phase === \"processing\" || phase === \"queued\" ? \"Working...\" : \"Generate\"}\n        </button>\n        <button\n          type=\"button\"\n          onClick={onReset}\n          className=\"px-3 py-2 rounded-md border\"\n        >\n          Reset\n        </button>\n\n        {downloadUrl && (\n          <a\n            href={downloadUrl}\n            className=\"ml-auto px-4 py-2 rounded-md border hover:bg-neutral-50 dark:hover:bg-neutral-800\"\n          >\n            Download\n          </a>\n        )}\n      </div>\n\n      {/* Status */}\n      {(message || phase !== \"idle\") && (\n        <div className=\"mt-3 text-sm\">\n          <strong>Status:</strong>{\" \"}\n          <span className={classNames(\n            phase === \"failed\" || phase === \"blocked\" ? \"text-red-600 dark:text-red-400\" : \"text-neutral-800 dark:text-neutral-200\"\n          )}>\n            {message || phase}\n          </span>\n          {phase === \"blocked\" && blockedReason && (\n            <div className=\"text-xs text-neutral-600 dark:text-neutral-400 mt-1\">\n              Reason: {blockedReason}\n            </div>\n          )}\n        </div>\n      )}\n\n      {/* Preview */}\n      {previewUrl && (\n        <div className=\"mt-4\">\n          <div className=\"text-sm mb-2\">Preview</div>\n          {/* eslint-disable-next-line @next/next/no-img-element */}\n          <img\n            src={previewUrl}\n            alt=\"Generated result\"\n            className=\"max-h-[480px] w-auto border rounded-md\"\n          />\n          <div className=\"text-xs text-neutral-600 dark:text-neutral-400 mt-1\">\n            Free tier receives visible watermark. Paid tiers are watermark-exempt.\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nasync function safeJson(res: Response): Promise<any | null> {\n  try {\n    return await res.json();\n  } catch {\n    return null;\n  }\n}"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 601, "column": 0}, "map": {"version":3,"sources":["file:///Users/robertstevens/Touchfeets/web/components/ContentWarning.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useEffect } from \"react\";\n\n/**\n * Informational-only content warning (no gating).\n * Requirements:\n * - Brief rules reminder (no minors; no nudity beyond feet; no hateful/violent content).\n * - Non-blocking (dismissible, stays dismissed via localStorage).\n */\nexport default function ContentWarning() {\n  const [open, setOpen] = useState(true);\n\n  useEffect(() => {\n    const dismissed = globalThis.localStorage?.getItem(\"cw_dismissed\");\n    if (dismissed === \"1\") setOpen(false);\n  }, []);\n\n  const dismiss = () => {\n    setOpen(false);\n    try {\n      globalThis.localStorage?.setItem(\"cw_dismissed\", \"1\");\n    } catch {\n      // ignore\n    }\n  };\n\n  if (!open) return null;\n\n  return (\n    <div\n      role=\"region\"\n      aria-label=\"Content rules\"\n      className=\"card border border-[rgba(225,6,60,0.35)] text-sm max-w-3xl w-full mx-auto p-4 mb-6\"\n    >\n      <div className=\"flex items-start gap-3\">\n        <div className=\"mt-0.5 text-[var(--color-accent)]\">⚠️</div>\n        <div className=\"flex-1\">\n          <h3 className=\"font-semibold\">Content rules</h3>\n          <ul className=\"list-disc pl-5 mt-2 space-y-1 text-[var(--color-muted)]\">\n            <li>No minors or faces of minors.</li>\n            <li>No nudity beyond feet.</li>\n            <li>No violent, hateful, or disrespectful content.</li>\n          </ul>\n          <p className=\"mt-2 text-[var(--color-muted)]\">\n            Uploads may be moderated automatically. Blocked images will include a brief reason and guidance.\n          </p>\n        </div>\n        <button\n          onClick={dismiss}\n          className=\"ml-2 rounded-full border border-[rgba(225,6,60,0.35)] px-3 py-1 hover:border-[rgba(225,6,60,0.7)] transition\"\n          aria-label=\"Dismiss content rules\"\n        >\n          Dismiss\n        </button>\n      </div>\n    </div>\n  );\n}"],"names":[],"mappings":";;;;;AAEA;AAFA;;;AAUe,SAAS;IACtB,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,iNAAQ,EAAC;IAEjC,IAAA,kNAAS,EAAC;QACR,MAAM,YAAY,WAAW,YAAY,EAAE,QAAQ;QACnD,IAAI,cAAc,KAAK,QAAQ;IACjC,GAAG,EAAE;IAEL,MAAM,UAAU;QACd,QAAQ;QACR,IAAI;YACF,WAAW,YAAY,EAAE,QAAQ,gBAAgB;QACnD,EAAE,OAAM;QACN,SAAS;QACX;IACF;IAEA,IAAI,CAAC,MAAM,OAAO;IAElB,qBACE,8OAAC;QACC,MAAK;QACL,cAAW;QACX,WAAU;kBAEV,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAI,WAAU;8BAAoC;;;;;;8BACnD,8OAAC;oBAAI,WAAU;;sCACb,8OAAC;4BAAG,WAAU;sCAAgB;;;;;;sCAC9B,8OAAC;4BAAG,WAAU;;8CACZ,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;8CACJ,8OAAC;8CAAG;;;;;;;;;;;;sCAEN,8OAAC;4BAAE,WAAU;sCAAiC;;;;;;;;;;;;8BAIhD,8OAAC;oBACC,SAAS;oBACT,WAAU;oBACV,cAAW;8BACZ;;;;;;;;;;;;;;;;;AAMT","debugId":null}}]
}